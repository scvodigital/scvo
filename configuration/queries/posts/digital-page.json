{
  "size": 4,
  "_source": [
    "wpid",
    "title",
    "path",
    "author_name_full",
    "author_slug",
    "author_avatar",
    "og_image",
    "publish_on",
    "updated",
    "description_truncated"
  ],
  "query": {
    "function_score": {
      "query": {
        "bool": {
          "must_not": [
            {
              "term": {
                "hide_in_results": true
              }
            },
            {
              "term": {
                "hide_from_search": "1"
              }
            }
          ],
          "must": {
            "match_all": {}
          }
          {{#if @root.data.primaryResponse.hits.hits.[0] ~}},
          "should": [
            {
              "terms": {
                "categories_id": [
                  {{join @root.data.primaryResponse.hits.hits.[0]._source.categories_id}}
                ]
              }
            }
          ],
          "minimum_should_match": 1
          {{/if ~}}
        }
      },
      "random_score": {},
      "score_mode": "sum"
    }
  },
  "sort": {
    "publish_on": "desc"
  }
}
